---
title: "Baixando Dados"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Baixando Dados com fetcher}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
O Fetcher realiza a importação dos dados das apis da Câmara e do Senado.

Para que um Projeto de Lei (PL) seja aprovado, é necessário que ele passe pelas duas casas do Congresso (Câmara e Senado), podendo iniciar em qualquer uma delas e tendo que passar pela outra para revisão. A primeira casa na qual o PL passar será chamada Casa de Origem, e a segunda, Casa Revisora.

O primeiro passo para obter dados de qualquer PL é identificar os ids do mesmo na Câmara e/ou no Senado. [Link para instruções sobre como achar o id de um PL](https://github.com/analytics-ufcg/agora-digital#como-capturar-ids-de-proposi%C3%A7%C3%B5es). 

Nesse exemplo, vamos utilizar a Lei da Qualidade Fiscal (PLS 229/2009 - Senado | PLP 295/2016 - Câmara).


```{r message=FALSE}
library(agoradigital)
library(rcongresso)
library(tidyverse)

id_qualidade_fiscal_senado <- 91341
id_qualidade_fiscal_camara <- 2088990
```

### Dados Gerais

Para adquirir informações gerais sobre uma proposição usamos o método fetch_proposição(id, casa).
A função `fetch_proposicao()` retornará um dataframe contendo colunas com informações gerais sobre a proposição, como autor, ano, situação, ementa, relator e etc

#### Câmara

```{r message=FALSE}
prop_camara <- fetch_proposicao(id_qualidade_fiscal_camara, 'camara')
glimpse(prop_camara)
```

#### Senado

```{r message=FALSE}
prop_senado <- fetch_proposicao(id_qualidade_fiscal_senado, 'senado')
glimpse(prop_senado)
```

### Dados da Tramitação
A função `fetch_tramitacao()` tem todos os acontecimentos da proposição ordenados por suas datas, contendo a descrição dos mesmos.


|    Coluna     |   Descrição   |
| ------------- | ------------- |
|   dataHora    |     Data      |
|   descricaoSituacao  | Descricao da situacao  |
| descricaoTramitacao  | Descrição do evento na tramitação |
| despacho  | Despacho do acontecimento  |
| id_prop  | id da proposição que está sendo mostrada a tramitaçao  |
| idSituacao  | id da situação que está ocorrendo naquela linha  |
| idTipoTramitacao  | id do tipo de tramitação que está ocorrendo naquela linha  |
| regime  | Informa em que regime a tramitação está naquele momento podendo ser urgente ou normal por exemplo  |
| sequencia  | Enumeração da sequência de eventos  |
| siglaOrgao  | Orgão em que está ocorrendo o acontecimento  |
| uriOrgao  | url do orgão no site da casa  |
| url  | url do acontecimento  |

#### Câmara

```{r message=FALSE}
tram_camara <- rcongresso::fetch_tramitacao(id_qualidade_fiscal_camara)
glimpse(tram_camara)
```

#### Senado

```{r message=FALSE}
tram_senado <- agoradigital::fetch_tramitacao(id_qualidade_fiscal_senado)
glimpse(tram_senado)
```